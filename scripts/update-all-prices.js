const fs = require('fs');
const path = require('path');

// 价格映射 (商品编号 -> 价格)
const prices = {
  5: 74.80, 6: 48.90, 7: 55.90, 8: 37.90, 9: 60.90, 10: 106.90, 11: 99.80, 12: 65.90, 13: 59.90, 14: 75.90, 15: 92.90, 16: 95.90,
  17: 53.90, 18: 54.90, 19: 59.90, 20: 41.90, 21: 74.90, 22: 47.90, 23: 37.90, 24: 64.90, 25: 99.90, 26: 74.90,
  27: 54.90, 28: 55.90, 29: 104.90, 30: 54.90, 31: 47.90, 32: 54.90, 33: 64.90, 34: 64.90, 35: 54.90, 36: 48.90, 37: 54.90,
  38: 106.90, 39: 204.90, 40: 74.90, 41: 174.90, 42: 94.90, 43: 94.90, 44: 153.90, 45: 164.90, 46: 83.90, 47: 84.90,
  48: 84.90, 49: 164.90, 50: 74.90, 51: 174.90, 52: 94.90, 53: 64.90, 54: 74.90, 55: 74.90, 56: 154.80, 57: 54.90,
  58: 104.90, 59: 64.90, 60: 54.90, 61: 74.90, 62: 74.90, 63: 64.90, 64: 74.90, 65: 104.90, 66: 74.90, 67: 54.90,
  68: 54.90, 69: 74.90, 70: 94.90, 71: 104, 72: 110.90, 73: 60.90, 74: 54.90, 75: 354, 76: 134.90, 77: 111.90,
  78: 54.90, 79: 73, 80: 84.90, 81: 61.90, 82: 74.90, 83: 50.90, 84: 104, 85: 54.90, 86: 114.90, 87: 74.90,
  88: 84.90, 89: 704, 90: 804.90, 91: 80.90, 92: 344.90, 93: 804, 94: 994.90, 95: 894.90, 96: 74.90, 97: 73,
  98: 174, 99: 84.90, 100: 74.90, 101: 69.90, 102: 64.90, 103: 55.90, 104: 88.90, 105: 66.90, 106: 64.90, 107: 50.90,
  108: 80.90, 109: 94.90, 110: 73, 111: 84.90, 112: 104.90, 113: 84.90, 114: 64.90, 115: 61.90, 116: 114.90, 117: 94.90,
  118: 114.90, 119: 73, 120: 104.90, 121: 104.90, 122: 69.90, 123: 53, 124: 74.90, 125: 94.90, 126: 74.90, 127: 174.90,
  128: 120.90, 129: 94.90, 130: 104.90, 131: 129.90, 132: 114.90, 133: 104.90, 134: 74.90, 135: 94, 136: 74.90, 137: 40.90,
  138: 84.90, 139: 64.90, 140: 74.80, 141: 114.90, 142: 94, 143: 74.90, 144: 104.90, 145: 84.90, 146: 94.90, 147: 74.90,
  148: 94.90, 149: 84.90, 150: 114.90, 151: 74.80, 152: 84.90
};

// 读取商品详情页文件
const detailPagePath = path.join(__dirname, '../app/product/[id]/page.tsx');
let content = fs.readFileSync(detailPagePath, 'utf8');

// 替换所有价格
Object.keys(prices).forEach(productNum => {
  const price = prices[productNum];
  // 匹配格式: { id: 'X', name: '山姆商品X ...', price: XX.XX, imageUrl: '/XX.webp',
  const regex = new RegExp(
    `(\\{\\s*id:\\s*'${productNum}',\\s*name:\\s*'[^']+',\\s*price:\\s*)([\\d.]+)(,\\s*imageUrl:)`,
    'g'
  );
  content = content.replace(regex, `$1${price}$3`);
});

// 写回文件
fs.writeFileSync(detailPagePath, content, 'utf8');
console.log('✓ 商品详情页价格已更新');

// 更新分类页
const categoryPagePath = path.join(__dirname, '../app/category/[id]/page.tsx');
let categoryContent = fs.readFileSync(categoryPagePath, 'utf8');

// 分类页商品ID映射
const categoryIdMapping = {
  '30': 17, '32': 18, '34': 19, '36': 20, '38': 21, '40': 22, '41': 23, '42': 24, '43': 25, '44': 26,
  '45': 27, '46': 28, '47': 29, '48': 30, '49': 31, '50': 32, '51': 33, '52': 34, '53': 35, '54': 36, '55': 37,
  '56': 38, '57': 39, '60': 40, '61': 41, '63': 42, '65': 43, '66': 44, '67': 45, '68': 46, '69': 47,
  '70': 48, '72': 49, '73': 50, '74': 51, '75': 52, '76': 53, '77': 54, '78': 55, '79': 56, '80': 57,
  '81': 58, '82': 59, '83': 60, '84': 61, '85': 62, '86': 63, '87': 64, '88': 65, '89': 66,
  '90': 67, '91': 68, '92': 69, '93': 70, '94': 71, '95': 72, '96': 73, '97': 74, '98': 75, '99': 76,
  '100': 77, '101': 78, '102': 79, '103': 80, '104': 81, '105': 82, '106': 83, '107': 84, '108': 85, '109': 86,
  '110': 87, '111': 88,
  '112': 89, '113': 90, '114': 91, '115': 92, '116': 93, '117': 94, '118': 95, '119': 96, '120': 97, '121': 98,
  '122': 99, '123': 100, '124': 101, '125': 102, '127': 103, '128': 104, '129': 105, '130': 106, '131': 107,
  '132': 108, '133': 109, '134': 110, '135': 111, '136': 112, '137': 113, '138': 114, '139': 115, '140': 116,
  '141': 117, '142': 118, '143': 119, '144': 120, '145': 121, '146': 122, '147': 123, '148': 124, '149': 125,
  '150': 126, '151': 127, '152': 128, '153': 129, '154': 130, '155': 131, '156': 132, '158': 133, '159': 134,
  '160': 135, '161': 136, '162': 137, '163': 138, '164': 139, '165': 140, '166': 141, '167': 142,
  '168': 143, '169': 144, '170': 145, '171': 146, '172': 147, '173': 148, '174': 149, '175': 150, '176': 151, '177': 152
};

Object.keys(categoryIdMapping).forEach(categoryId => {
  const productNum = categoryIdMapping[categoryId];
  const price = prices[productNum];
  if (price) {
    const regex = new RegExp(
      `(\\{\\s*id:\\s*'${categoryId}',\\s*name:\\s*'[^']+',\\s*specs:\\s*'[^']+',\\s*price:\\s*)([\\d.]+)(,\\s*imageUrl:)`,
      'g'
    );
    categoryContent = categoryContent.replace(regex, `$1${price}$3`);
  }
});

fs.writeFileSync(categoryPagePath, categoryContent, 'utf8');
console.log('✓ 分类页价格已更新');

console.log('\n所有价格更新完成！');
